NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg38'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg38'
OUT_DIR <- 'images'
###
bed_df <- read.delim(paste0('data/', NAME, '.bed'), as.is = TRUE, header = FALSE)
colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
bed_df$len <- bed_df$end - bed_df$start
head(bed_df)
# hist(bed_df$len)
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('len_hist.', NAME, '.pdf'), path = OUT_DIR)
source('lib.R')
###
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg38'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19'
NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg38'
###
bed_df <- read.delim(paste0(DATA_DIR, NAME, '.bed'), as.is = TRUE, header = FALSE)
#colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
colnames(bed_df) <- c('chrom', 'start', 'end')
bed_df$len <- bed_df$end - bed_df$start
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('len_hist.', NAME, '.pdf'), path = OUT_DIR)
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg38'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19'
NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg38'
###
bed_df <- read.delim(paste0(DATA_DIR, NAME, '.bed'), as.is = TRUE, header = FALSE)
#colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
colnames(bed_df) <- c('chrom', 'start', 'end')
bed_df$len <- bed_df$end - bed_df$start
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('len_hist.', NAME, '.pdf'), path = OUT_DIR)
source('~/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src/len_hist.R')
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg38'
NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg38'
###
bed_df <- read.delim(paste0(DATA_DIR, NAME, '.bed'), as.is = TRUE, header = FALSE)
#colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
colnames(bed_df) <- c('chrom', 'start', 'end')
bed_df$len <- bed_df$end - bed_df$start
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('len_hist.', NAME, '.pdf'), path = OUT_DIR)
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19'
NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg38'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg38'
###
bed_df <- read.delim(paste0(DATA_DIR, NAME, '.bed'), as.is = TRUE, header = FALSE)
#colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
colnames(bed_df) <- c('chrom', 'start', 'end')
bed_df$len <- bed_df$end - bed_df$start
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('len_hist.', NAME, '.pdf'), path = OUT_DIR)
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg38'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg38'
###
bed_df <- read.delim(paste0(DATA_DIR, NAME, '.bed'), as.is = TRUE, header = FALSE)
#colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
colnames(bed_df) <- c('chrom', 'start', 'end')
bed_df$len <- bed_df$end - bed_df$start
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('len_hist.', NAME, '.pdf'), path = OUT_DIR)
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19'
###
bed_df <- read.delim(paste0(DATA_DIR, NAME, '.bed'), as.is = TRUE, header = FALSE)
colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
bed_df$len <- bed_df$end - bed_df$start
head(bed_df)
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('filter_peaks.', NAME, '.init.hist.pdf'), path = OUT_DIR)
# Remove long peaks
bed_df <- bed_df %>%
arrange(-len) %>%
filter(len < 5000)
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('filter_peaks.', NAME, '.filtered.hist.pdf'), path = OUT_DIR)
bed_df %>%
select(-len) %>%
write.table(file=paste0(DATA_DIR, NAME ,'.filtered.bed'),
col.names = FALSE, row.names = FALSE, sep = '\t', quote = FALSE)
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19'
NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19'
###
bed_df <- read.delim(paste0(DATA_DIR, NAME, '.bed'), as.is = TRUE, header = FALSE)
colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
bed_df$len <- bed_df$end - bed_df$start
head(bed_df)
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('filter_peaks.', NAME, '.init.hist.pdf'), path = OUT_DIR)
# Remove long peaks
bed_df <- bed_df %>%
arrange(-len) %>%
filter(len < 5000)
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('filter_peaks.', NAME, '.filtered.hist.pdf'), path = OUT_DIR)
bed_df %>%
select(-len) %>%
write.table(file=paste0(DATA_DIR, NAME ,'.filtered.bed'),
col.names = FALSE, row.names = FALSE, sep = '\t', quote = FALSE)
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene")
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene")
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
#NAME <- 'H3K4me3_A549.intersect_with_DeepZ'
#NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
#pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
# peak <- readPeakFile(BED_FN)
# pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
# covplot(peak, weightCol="V5")
# dev.off()
#
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene")
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene", force = TRUE)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
BiocManager::install("GenomicFeatures", force = TRUE)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library.install("ellipsis")
library("ellipsis")
#library("ellipsis")
install.packages("ellipsis")
install.packages("ellipsis")
install.packages("ellipsis")
#library("ellipsis")
install.packages("ellipsis", force = TRUE)
#library("ellipsis")
install.packages("ellipsis", force = TRUE)
install.packages("ellipsis", force = TRUE)
install.packages("ellipsis", force = TRUE)
install.packages("ellipsis", force = TRUE)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
BiocManager::install("clusterProfiler", force = TRUE)
library(clusterProfiler)
library(ChIPseeker)
NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
#pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
# peak <- readPeakFile(BED_FN)
# pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
# covplot(peak, weightCol="V5")
# dev.off()
#
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene", force = TRUE)
BiocManager::install("org.Hs.eg.db")
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene", force = TRUE)
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
#NAME <- 'H3K4me3_A549.intersect_with_DeepZ'
#NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
#pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
# peak <- readPeakFile(BED_FN)
# pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
# covplot(peak, weightCol="V5")
# dev.off()
#
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene", force = TRUE)
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
#NAME <- 'H3K4me3_A549.intersect_with_DeepZ'
#NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
dev.off()
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene", force = TRUE)
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
#NAME <- 'H3K4me3_A549.intersect_with_DeepZ'
#NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
#dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
dev.off()
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
#BiocManager::install("TxDb.Hsapiens.UCSC.hg19.knownGene", force = TRUE)
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
#NAME <- 'H3K4me3_A549.intersect_with_DeepZ'
#NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
#png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
dev.off()
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
#NAME <- 'H3K4me3_A549.intersect_with_DeepZ'
#NAME <- 'DeepZ'
NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
#png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
dev.off()
png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg38'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg38'
###
bed_df <- read.delim(paste0(DATA_DIR, NAME, '.bed'), as.is = TRUE, header = FALSE)
#colnames(bed_df) <- c('chrom', 'start', 'end', 'name', 'score')
colnames(bed_df) <- c('chrom', 'start', 'end')
bed_df$len <- bed_df$end - bed_df$start
ggplot(bed_df) +
aes(x = len) +
geom_histogram() +
ggtitle(NAME, subtitle = sprintf('Number of peaks = %s', nrow(bed_df))) +
theme_bw()
ggsave(paste0('len_hist.', NAME, '.pdf'), path = OUT_DIR)
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
#NAME <- 'H3K4me3_A549.intersect_with_DeepZ'
NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
#png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
dev.off()
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
#NAME <- 'H3K4me3_A549.intersect_with_DeepZ'
NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
#png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
covplot(peak) #, weightCol="V5")
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak) #, weightCol="V5")
dev.off()
png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
NAME <- 'H3K9me3_A549.intersect_with_DeepZ'
#NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
#png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak, weightCol="V5")
dev.off()
setwd("/Users/isaf27/Documents/3rd_course/bio/project/hse21_H3K9me3_ZDNA_human/src")
source('lib.R')
###
library(ChIPseeker)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(clusterProfiler)
###
NAME <- 'H3K9me3_A549.intersect_with_DeepZ'
#NAME <- 'DeepZ'
#NAME <- 'H3K9me3_A549.ENCFF811QUJ.hg19.filtered'
#NAME <- 'H3K9me3_A549.ENCFF444EWQ.hg19.filtered'
BED_FN <- paste0(DATA_DIR, NAME, '.bed')
###
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peakAnno <- annotatePeak(BED_FN, tssRegion=c(-3000, 3000), TxDb=txdb, annoDb="org.Hs.eg.db")
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.pdf'))
#png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
peak <- readPeakFile(BED_FN)
pdf(paste0(OUT_DIR, 'chip_seeker.', NAME, '.covplot.pdf'))
covplot(peak) #, weightCol="V5")
dev.off()
png(paste0(OUT_DIR, 'chip_seeker.', NAME, '.plotAnnoPie.png'))
plotAnnoPie(peakAnno)
dev.off()
